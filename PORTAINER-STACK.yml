# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# TimInvest - Stack Portainer
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# ğŸ“‹ INSTRUCTIONS D'UTILISATION DANS PORTAINER :
# 
# 1. Construisez d'abord l'image sur votre machine :
#    docker build -t timinvest:latest .
#
# 2. Dans Portainer :
#    - Allez dans "Stacks"
#    - Cliquez sur "+ Add stack"
#    - Nom : timinvest
#    - Copiez-collez tout le contenu de ce fichier ci-dessous
#    - Cliquez sur "Deploy the stack"
#
# 3. Attendez 30 secondes que l'application dÃ©marre
#
# 4. AccÃ©dez Ã  : http://localhost:8547 (ou l'IP de votre serveur)
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ”§ CONFIGURATION :
# 
# Pour changer le port, modifiez la ligne "8547:3000" ci-dessous
# Exemple pour port 8080 : "8080:3000"
#
# Pour votre propre domaine, modifiez NEXT_PUBLIC_APP_URL
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

version: '3.8'

services:
  timinvest:
    build:
      context: .
      dockerfile: Dockerfile
    image: timinvest:latest
    container_name: timinvest
    restart: unless-stopped
    
    # Port d'accÃ¨s (modifiez si nÃ©cessaire)
    ports:
      - "8547:3000"
    
    # Variables d'environnement
    environment:
      - NODE_ENV=production
      # ClÃ© API Finnhub (dÃ©jÃ  configurÃ©e)
      - FINNHUB_API_KEY=d4b96lhr01qrv4ataf3gd4b96lhr01qrv4ataf40
      # URL de votre application
      - NEXT_PUBLIC_APP_URL=http://localhost:8547
    
    # Volume pour persistance des donnÃ©es
    volumes:
      - timinvest-data:/app/data
    
    # RÃ©seau
    networks:
      - timinvest-network
    
    # VÃ©rification de santÃ©
    healthcheck:
      test: ["CMD", "node", "-e", "require('http').get('http://localhost:3000', (r) => {process.exit(r.statusCode === 200 ? 0 : 1)})"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s
    
    # Labels pour Portainer
    labels:
      - "com.timinvest.description=Gestion de patrimoine boursier"
      - "com.timinvest.version=1.0.0"
      - "com.portainer.stack=timinvest"

# Volumes
volumes:
  timinvest-data:
    driver: local
    labels:
      - "com.timinvest.type=data"
      - "com.timinvest.description=DonnÃ©es du portfolio (actions et dividendes)"

# RÃ©seaux
networks:
  timinvest-network:
    driver: bridge
    labels:
      - "com.timinvest.network=main"

# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“Š APRÃˆS LE DÃ‰PLOIEMENT :
#
# Dans Portainer, vous verrez :
# - Container : timinvest (status: running, health: healthy)
# - Volume : timinvest-data (vos donnÃ©es)
# - Network : timinvest-network
#
# Pour voir les logs : Containers > timinvest > Logs
# Pour redÃ©marrer : Containers > timinvest > Restart
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

